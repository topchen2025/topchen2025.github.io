<!doctype html>
<html lang="zh-Hans" data-theme>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DevCast Â· å¼€å‘é£æ ¼æ’­å®¢</title>
  <meta name="description" content="ä¸€ä¸ªé¢å‘å¼€å‘è€…çš„æç®€æ’­å®¢ä¸»é¡µï¼Œæš—è‰²ä¸»é¢˜ã€é”®ç›˜å¿«æ·é”®ã€ç¦»æ•£ç»„ä»¶ã€‚" />
  <meta name="theme-color" content="#0b0f12" />
  <link rel="alternate" type="application/rss+xml" title="DevCast RSS" href="feed.xml" />
  <style>
    :root{
      --bg: #0b0f12;           /* èƒŒæ™¯ */
      --panel: #0f1419;        /* å¡ç‰‡èƒŒæ™¯ */
      --fg: #e6edf3;           /* æ­£æ–‡ */
      --muted: #9da8b3;        /* æ¬¡è¦æ–‡å­— */
      --line: #1b2026;         /* ç»†çº¿ */
      --accent: #00ff88;       /* èµ›åšç»¿ */
      --accent-2: #7cffd3;     /* å¤‡ç”¨é«˜äº® */
      --danger: #ff5d5d;
      --radius: 14px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fa; --panel:#ffffff; --fg:#0e1116; --muted:#57606a; --line:#e6edf3;
      }
      body { background-image: radial-gradient(1000px 600px at 10% 0, #eaf2ff 0%, transparent 60%); }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font: 16px/1.6 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "JetBrains Mono", monospace;
      letter-spacing:.2px;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{color:var(--accent-2);}

    /* é¡¶éƒ¨å¯¼èˆª */
    .nav{
      position:sticky; top:0; z-index:10; backdrop-filter: blur(8px);
      background: color-mix(in srgb, var(--bg) 70%, transparent);
      border-bottom:1px solid var(--line);
    }
    .container{max-width:1000px; margin:0 auto; padding:16px 20px}
    .row{display:flex; align-items:center; gap:14px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:700}
    .logo{
      width:28px; height:28px; display:grid; place-items:center; border-radius:8px;
      background: linear-gradient(135deg, var(--accent) 0%, #0affc2 100%);
      color:#001a10; font-weight:900; box-shadow: var(--shadow);
    }
    .spacer{flex:1}
    .btn{
      border:1px solid var(--line); background:var(--panel); color:var(--fg);
      padding:8px 12px; border-radius:10px; cursor:pointer; transition:.15s ease-in-out;
    }
    .btn:hover{transform: translateY(-1px); border-color: color-mix(in srgb, var(--accent) 35%, var(--line));}
    .btn-ghost{background:transparent}

    /* å¤´å›¾ */
    .hero{border-bottom:1px solid var(--line); background:radial-gradient(750px 300px at 85% -40%, rgba(0,255,136,.07), transparent 60%)}
    .hero h1{font-size:32px; margin:6px 0 8px}
    .hero p{margin:0; color:var(--muted)}

    /* æœç´¢æ  */
    .search{display:flex; gap:10px; align-items:center; margin:16px 0 0}
    .search input{
      flex:1; border-radius:12px; border:1px solid var(--line); padding:12px 14px 12px 42px;
      background:var(--panel); color:var(--fg); outline:none;
    }
    .search .kbd{
      position:absolute; margin-left:10px; color:var(--muted); pointer-events:none
    }

    /* åˆ—è¡¨ */
    .list{display:grid; gap:14px; margin:20px 0 60px}
    .card{
      display:grid; grid-template-columns: 1fr; gap:10px; padding:14px; border-radius: var(--radius);
      background:var(--panel); border:1px solid var(--line); box-shadow: var(--shadow);
    }
    .meta{display:flex; gap:12px; align-items:center; color:var(--muted); font-size:13px}
    .tag{display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid var(--line); color:var(--muted); margin-right:6px}
    .title{font-size:18px; font-weight:700; margin:2px 0}
    audio{ width:100%; height:36px; }
    .actions{display:flex; gap:10px; align-items:center}

    /* é¡µè„š */
    footer{border-top:1px solid var(--line); color:var(--muted)}

    /* å¿«æ·é”®æç¤ºå±‚ */
    .hotkeys{
      position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6);
    }
    .hotkeys .panel{
      width:min(720px, 92vw); background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:16px;
    }
    .hotkeys table{width:100%; border-collapse:collapse}
    .hotkeys td{padding:6px 8px; border-bottom:1px dashed var(--line); color:var(--muted)}
    .kbd-inline{display:inline-block; padding:0 6px; border:1px solid var(--line); border-bottom-width:2px; border-radius:6px; margin:0 2px}

    /* é€‰ä¸­é«˜äº® */
    .card[aria-current="true"]{ outline:2px solid var(--accent); box-shadow:0 0 0 3px rgba(0,255,136,.15), var(--shadow)}

    /* å°å±ä¼˜åŒ– */
    @media (min-width: 720px){
      .hero h1{font-size:38px}
      .card{grid-template-columns: auto 1fr}
      .title{font-size:20px}
    }
  </style>
</head>
<body>
  <header class="nav">
    <div class="container row">
      <div class="brand" title="è¿”å›é¦–é¡µ">
        <div class="logo">â–¶</div>
        <div>
          <div>DevCast</div>
          <small style="color:var(--muted)">å¼€å‘è€…é£æ ¼æ’­å®¢</small>
        </div>
      </div>
      <div class="spacer"></div>
      <button id="themeToggle" class="btn btn-ghost" title="åˆ‡æ¢ä¸»é¢˜ (t)">â˜¾/â˜€</button>
      <a class="btn" href="feed.xml" title="è®¢é˜… RSS">RSS</a>
      <button id="helpBtn" class="btn btn-ghost" title="å¿«æ·é”® (Shift + /)">?</button>
    </div>
  </header>

  <section class="hero">
    <div class="container">
      <h1>ä½ å¥½ï¼Œå¼€å‘è€… ğŸ‘‹</h1>
      <p>è¿™æ˜¯ä¸€ä¸ªä¸ä¾èµ–ä»»ä½•æ¡†æ¶çš„é™æ€æ’­å®¢é¦–é¡µï¼šæš—è‰²ä¼˜å…ˆã€é”®ç›˜å¯æ“ä½œã€åªæœ‰ä¸€ä»½ <code>index.html</code>ã€‚æŠŠå®ƒæ”¾è¿› GitHub Pages å³å¯ä¸Šçº¿ã€‚</p>
      <div class="search">
        <span class="kbd">/</span>
        <input id="search" type="search" placeholder="æœç´¢ï¼šæ ‡é¢˜ã€æ ‡ç­¾æˆ–æ‘˜è¦ï¼ˆæŒ‰ / èšç„¦ï¼‰" autocomplete="off" />
      </div>
    </div>
  </section>

  <main class="container">
    <div id="list" class="list" role="list" aria-label="èŠ‚ç›®åˆ—è¡¨"></div>
  </main>

  <footer class="container" style="padding-bottom:60px">
    <p>Â© <span id="year"></span> DevCast Â· ä»¥ <span style="color:var(--accent)">å¼€å‘è€…ä½“éªŒ</span> ä¸ºä¸­å¿ƒæ„å»ºã€‚
      | <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>
      | <a href="#" id="exportJson">å¯¼å‡º JSON</a>
    </p>
  </footer>

  <!-- å¿«æ·é”®å¸®åŠ© -->
  <div id="hotkeys" class="hotkeys" aria-hidden="true">
    <div class="panel">
      <h3 style="margin:6px 0 10px">é”®ç›˜å¿«æ·é”®</h3>
      <table>
        <tr><td><span class="kbd-inline">/</span></td><td>èšç„¦æœç´¢</td></tr>
        <tr><td><span class="kbd-inline">j</span> / <span class="kbd-inline">k</span></td><td>ä¸Šä¸‹é€‰æ‹©èŠ‚ç›®</td></tr>
        <tr><td><span class="kbd-inline">ç©ºæ ¼</span> æˆ– <span class="kbd-inline">Enter</span></td><td>æ’­æ”¾/æš‚åœé€‰ä¸­èŠ‚ç›®</td></tr>
        <tr><td><span class="kbd-inline">t</span></td><td>åˆ‡æ¢æ·±æµ…è‰²</td></tr>
        <tr><td><span class="kbd-inline">g</span> <span class="kbd-inline">g</span></td><td>å›åˆ°é¡¶éƒ¨</td></tr>
        <tr><td><span class="kbd-inline">Shift</span> + <span class="kbd-inline">/</span></td><td>æ˜¾ç¤º/å…³é—­æœ¬å¸®åŠ©</td></tr>
      </table>
    </div>
  </div>

  <!-- ä½ çš„æ’­å®¢æ•°æ®ï¼šä¿®æ”¹å³å¯ä¸ªæ€§åŒ–ï¼ˆä¹Ÿå¯æ›¿æ¢ä¸ºå¤–éƒ¨ JSON å†ç”¨ fetch åŠ è½½ï¼‰ -->
  <script id="data" type="application/json">{
    "site": {
      "title": "DevCast",
      "subtitle": "å¼€å‘è€…é£æ ¼æ’­å®¢",
      "description": "è°ˆæŠ€æœ¯ã€èŠäº§å“ï¼Œä¹ŸèŠä½œä¸ºå¼€å‘è€…çš„èŒä¸šæ€è€ƒã€‚",
      "author": "Your Name",
      "links": { "github": "https://github.com/yourname" }
    },
    "episodes": [
      {
        "id": "ep-001",
        "title": "Hello, Worldï¼šä¸ºä»€ä¹ˆæ˜¯å¦ä¸€ä¸ªæ’­å®¢ï¼Ÿ",
        "date": "2025-01-10",
        "duration": "12:34",
        "audio": "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
        "summary": "å¼€åœºç™½ï¼šå®šä½ã€é€‰é¢˜å’Œæˆ‘ä»¬æƒ³ä¼ é€’çš„ä»·å€¼ã€‚",
        "tags": ["intro", "meta"]
      },
      {
        "id": "ep-002",
        "title": "ä»è„šæ‰‹æ¶åˆ°DXï¼šå¼€å‘ä½“éªŒçš„å››ä¸ªå±‚æ¬¡",
        "date": "2025-02-02",
        "duration": "28:15",
        "audio": "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
        "summary": "èŠèŠCLIã€æ¨¡ç‰ˆã€DevServerã€çƒ­æ›´æ–°ä¸é”™è¯¯åé¦ˆã€‚",
        "tags": ["dx", "tooling"]
      },
      {
        "id": "ep-003",
        "title": "è¾¹ç•Œä¸æˆæœ¬ï¼šä½•æ—¶è¯¥â€œå†™ä¸ªå°æœåŠ¡â€ï¼Ÿ",
        "date": "2025-05-18",
        "duration": "36:42",
        "audio": "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3",
        "summary": "å·¥ç¨‹å®è·µä¸­çš„å¤ç”¨ã€å°è£…ä¸SLAæ€ç»´ã€‚",
        "tags": ["architecture", "practice"]
      }
    ]
  }</script>

  <script>
    // ===== å·¥å…·å‡½æ•° =====
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
    const fmt = (d) => new Date(d + 'T00:00:00').toLocaleDateString(undefined, {year:'numeric', month:'short', day:'numeric'});
    const byId = id => document.getElementById(id);
    const storage = {
      get(k, def){ try { return JSON.parse(localStorage.getItem(k)) ?? def } catch { return def } },
      set(k, v){ localStorage.setItem(k, JSON.stringify(v)) }
    };

    // ===== ä¸»é¢˜åˆ‡æ¢ =====
    const THEME_KEY = 'devcast.theme';
    function applyTheme(theme){
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = theme ? (theme==='dark') : prefersDark;
      document.documentElement.toggleAttribute('data-theme', true);
      document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';
      document.body.dataset.theme = isDark ? 'dark' : 'light';
    }

    // ===== æ¸²æŸ“èŠ‚ç›®åˆ—è¡¨ =====
    const data = JSON.parse(byId('data').textContent);
    document.title = `${data.site.title} Â· å¼€å‘é£æ ¼æ’­å®¢`;
    $('.brand div:first-child + small').textContent = data.site.subtitle;

    const listEl = byId('list');
    let selectedIndex = 0;
    let audios = [];

    function episodeCard(ep){
      const el = document.createElement('article');
      el.className = 'card';
      el.id = ep.id;
      el.setAttribute('role','listitem');
      el.innerHTML = `
        <div style="display:flex; flex-direction:column; gap:6px">
          <div class="meta">
            <span title="å‘å¸ƒæ—¥æœŸ">ğŸ—“ï¸ ${fmt(ep.date)}</span>
            <span title="æ—¶é•¿">â±ï¸ ${ep.duration}</span>
            <span class="tags">${(ep.tags||[]).map(t=>`<span class=tag>#${t}</span>`).join('')}</span>
          </div>
          <h3 class="title">${ep.title}</h3>
          <p style="margin:0; color:var(--muted)">${ep.summary||''}</p>
          <div class="actions">
            <audio preload="none" controls src="${ep.audio}" data-id="${ep.id}"></audio>
            <button class="btn btn-ghost copy" title="å¤åˆ¶éŸ³é¢‘åœ°å€">å¤åˆ¶é“¾æ¥</button>
            <a class="btn" href="${ep.audio}" download>ä¸‹è½½</a>
          </div>
        </div>
      `;
      return el;
    }

    function render(filter=''){
      listEl.innerHTML = '';
      const q = filter.trim().toLowerCase();
      const filtered = data.episodes.filter(ep=>{
        if(!q) return true;
        const inText = [ep.title, ep.summary, ...(ep.tags||[])].join(' ').toLowerCase();
        return inText.includes(q);
      });
      filtered.sort((a,b)=> new Date(b.date) - new Date(a.date));
      filtered.forEach(ep=> listEl.appendChild(episodeCard(ep)));
      audios = $$('audio', listEl);
      audios.forEach(wireAudio);
      if(filtered.length){
        const hashId = location.hash.slice(1);
        const idx = filtered.findIndex(e=> e.id===hashId);
        selectedIndex = Math.max(0, idx);
        setSelected(selectedIndex);
      }
    }

    function setSelected(i){
      const cards = $$('.card', listEl);
      cards.forEach(c=>c.setAttribute('aria-current','false'));
      const card = cards[i]; if(!card) return;
      card.setAttribute('aria-current','true');
      card.scrollIntoView({block:'nearest', behavior:'smooth'});
    }

    function playSelected(){
      const a = audios[selectedIndex];
      if(!a) return;
      if(a.paused){ a.play(); } else { a.pause(); }
    }

    function wireAudio(audio){
      const id = audio.dataset.id;
      // æ¢å¤è¿›åº¦
      const t = storage.get('progress:'+id, 0);
      if (t>0) audio.currentTime = t;
      audio.addEventListener('timeupdate', ()=>{
        if(!audio.seeking && !audio.paused){ storage.set('progress:'+id, audio.currentTime); }
      });
      audio.addEventListener('play', ()=>{
        // ä¿è¯å•ä¾‹æ’­æ”¾
        audios.forEach(x=>{ if(x!==audio) x.pause(); });
        location.hash = id;
      });
      // å¤åˆ¶é“¾æ¥
      audio.closest('.card').querySelector('.copy').addEventListener('click', async ()=>{
        try{ await navigator.clipboard.writeText(audio.src); flash(`å·²å¤åˆ¶ï¼š${audio.src}`); }
        catch{ flash('å¤åˆ¶å¤±è´¥', true); }
      });
    }

    function flash(text, danger=false){
      const n = document.createElement('div');
      n.textContent = text; n.style.position='fixed'; n.style.bottom='20px'; n.style.left='50%'; n.style.transform='translateX(-50%)';
      n.style.padding='8px 12px'; n.style.border='1px solid var(--line)'; n.style.background='var(--panel)'; n.style.color = danger? 'var(--danger)': 'var(--fg)';
      n.style.borderRadius='10px'; n.style.boxShadow='var(--shadow)'; n.style.zIndex='99';
      document.body.appendChild(n); setTimeout(()=> n.remove(), 1800);
    }

    // æœç´¢
    const search = byId('search');
    search.addEventListener('input', ()=> render(search.value));

    // å¯¼å‡º JSONï¼ˆæ–¹ä¾¿å¤‡ä»½ä½ çš„èŠ‚ç›®æ•°æ®ï¼‰
    byId('exportJson').addEventListener('click', (e)=>{
      e.preventDefault();
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = Object.assign(document.createElement('a'), {href:url, download:'devcast.json'});
      a.click(); setTimeout(()=> URL.revokeObjectURL(url), 500);
    });

    // é¡¶æ æ§ä»¶
    byId('themeToggle').addEventListener('click', ()=>{
      const next = (document.body.dataset.theme==='dark')? 'light':'dark';
      storage.set(THEME_KEY, next); applyTheme(next); 
    });

    // çƒ­é”®
    const hotkeys = byId('hotkeys');
    const helpBtn = byId('helpBtn');
    helpBtn.addEventListener('click', ()=>{
      hotkeys.style.display = hotkeys.style.display==='grid' ? 'none' : 'grid';
      hotkeys.setAttribute('aria-hidden', hotkeys.style.display==='none');
    });
    hotkeys.addEventListener('click', (e)=>{ if(e.target===hotkeys) helpBtn.click(); });

    let gg = 0; // å¤„ç† g g
    window.addEventListener('keydown', (e)=>{
      if(e.key === '/' && document.activeElement !== search){ e.preventDefault(); search.focus(); return; }
      if(e.key === 't'){ applyTheme(document.body.dataset.theme==='dark' ? 'light':'dark'); storage.set(THEME_KEY, document.body.dataset.theme); }
      if(e.shiftKey && e.key === '?'){ helpBtn.click(); return; }

      const cards = $$('.card', listEl);
      if(['j','k','Enter',' '].includes(e.key)) e.preventDefault();
      if(e.key==='j'){ selectedIndex = Math.min(selectedIndex+1, cards.length-1); setSelected(selectedIndex); }
      if(e.key==='k'){ selectedIndex = Math.max(selectedIndex-1, 0); setSelected(selectedIndex); }
      if(e.key===' ' || e.key==='Enter'){ playSelected(); }
      if(e.key==='g'){ gg = (Date.now() - gg < 400) ? 0 : Date.now(); }
      else if(gg && e.key==='g'){ window.scrollTo({top:0, behavior:'smooth'}); gg = 0; }
    });

    // åˆå§‹åŒ–
    (function init(){
      applyTheme(storage.get(THEME_KEY));
      byId('year').textContent = new Date().getFullYear();
      render('');
      // å¦‚æœ URL å“ˆå¸ŒæŒ‡å®šäº†èŠ‚ç›®ï¼Œæ»šåŠ¨è‡³å®ƒ
      const hash = location.hash.slice(1);
      if(hash){ const el = byId(hash); el && el.scrollIntoView({block:'center'}); }
    })();
  </script>
</body>
</html>
